package Array.S2_MergeSort;

import java.util.Arrays;

import static Utils.Helpers.log;

/*
 * Merge Sorted Array
 *
 * - Given two sorted integer arrays nums1 and nums2, merge nums2 into nums1 as one sorted array.
 *
 * - Notes:
 *   1. The number of elements initialized in nums1 and nums2 are m and n respectively.
 *   2. Assume nums1 has enough space to hold elements from nums2 (nums1.length â‰¥ m + n).
 * */

public class L88_MergeSortedArray {
    /**
     * è§£æ³•1ï¼šcopy & sort
     * - æ€è·¯ï¼šå…ˆå°† nums2 çš„å…ƒç´ è¿½åŠ åˆ° nums1 å°¾éƒ¨ï¼Œç„¶åå¯¹ nums1 è¿›è¡Œæ’åºã€‚
     * - æ—¶é—´å¤æ‚åº¦ä¸º O(n + (m+n)log(m+n))ï¼Œå³ O(nlogn) é‡çº§ã€‚
     * - ç©ºé—´å¤æ‚åº¦ä¸º O(1)ï¼Œæ²¡æœ‰å¼€è¾Ÿé¢å¤–ç©ºé—´ã€‚
     */
    private static void merge(int[] nums1, int m, int[] nums2, int n) {
        for (int j = 0; j < nums2.length; j++)
            nums1[m + j] = nums2[j];
        Arrays.sort(nums1);
    }

    /*
     * è§£æ³•2ï¼šMerge sort
     * - æ€è·¯ï¼šè¦å°†ä¸¤ä¸ªæœ‰åºæ•°ç»„åˆäºŒä¸ºä¸€ï¼Œå¹¶ä¸”ç»“æœä¹Ÿè¦æœ‰åº âˆ´ æ•´ä½“æ€è·¯æ˜¯å½’å¹¶æ’åºã€‚
     * - ğŸ’ å®ç°ï¼šåŸºæœ¬çš„å½’å¹¶æ’åºçš„å®ç°æœ‰3ä¸ªè¦ç‚¹ï¼š
     *   1. è¦å¼€è¾Ÿè¾…åŠ©ç©ºé—´ï¼›
     *   2. éå†çš„æ˜¯è¯¥è¾…åŠ©ç©ºé—´é‡Œçš„æ¯ä¸ªä½ç½®ï¼ˆm + nï¼‰ï¼Œè€Œééå†å¾…åˆå¹¶æ•°ç»„ï¼›
     *   3. éå†è¿‡ç¨‹ä¸­å…ˆè®¨è®ºè¶Šç•Œæƒ…å†µï¼Œå†è®¨è®ºæ²¡è¶Šç•Œæƒ…å†µã€‚
     * - æ—¶é—´å¤æ‚åº¦ä¸º O(m+n)ï¼Œç©ºé—´å¤æ‚åº¦ O(m+n)ã€‚
     * */
    private static void merge2(int[] nums1, int m, int[] nums2, int n) {
        int[] aux = new int[m + n];             // å¼€è¾Ÿè¾…åŠ©ç©ºé—´
        int i = 0, j = 0;

        for (int k = 0; k < aux.length; k++) {  // ç¬¬1æ¬¡éå†
            if (i >= m)                         // å…ˆè®¨è®ºè¶Šç•Œçš„æƒ…å†µï¼ˆå·¦åŠéƒ¨åˆ†å·²å¤„ç†å®Œï¼‰
                aux[k] = nums2[j++];
            else if (j >= n)                    // è¶Šç•Œæƒ…å†µï¼ˆå³åŠéƒ¨åˆ†å·²å¤„ç†å®Œï¼‰
                aux[k] = nums1[i++];
            else if (nums1[i] <= nums2[j])      // å†è®¨è®ºæ²¡è¶Šç•Œæ—¶çš„æƒ…å†µ
                aux[k] = nums1[i++];
            else
                aux[k] = nums2[j++];
        }

        for (int l = 0; l < aux.length; l++)    // ç¬¬2æ¬¡éå†ï¼Œå°† aux ä¸­çš„å€¼é€ä¸ªèµ‹ç»™ nums1
            nums1[l] = aux[l];
    }

    /*
     * è§£æ³•3ï¼šMerge sortï¼ˆè§£æ³•1çš„æ—¶ç©ºä¼˜åŒ–ç‰ˆï¼‰
     * - æ€è·¯ï¼šä¸è§£æ³•1ä¸€è‡´ï¼Œéƒ½æ˜¯å½’å¹¶æ’åºã€‚
     * - å®ç°ï¼šè§£æ³•1ä¸­ä¹‹æ‰€ä»¥éœ€è¦è¾…åŠ©ç©ºé—´æ˜¯å› ä¸ºè‹¥åœ¨ nums1 ä¸­åŸåœ°æ’åºï¼Œå½“ nums1[i] > nums2[j] æ—¶ï¼Œéœ€ nums1[k] = nums2[j]ï¼Œ
     *   ä»è€Œå¯èƒ½å†²æ‰äº†è¿˜æœªå¤„ç†çš„å…ƒç´  nums1[k]ï¼Œå¯¼è‡´æ’åºé”™è¯¯ã€‚ä½†è¯¥é¢˜ä¸­è¯´äº† nums1 å°¾éƒ¨æœ‰è¶³å¤Ÿç©ºé—´ âˆ´ å¯ä»¥ç›´æ¥åˆ©ç”¨å°¾éƒ¨ç©ºé—´è€Œä¸å†
     *   é¢å¤–å¼€è¾Ÿæ–°ç©ºé—´ã€‚è€Œ âˆµ æ˜¯å°¾éƒ¨ç©ºé—´ âˆ´ éœ€è¦ä»åå¾€å‰å¡«å……ï¼ˆå³ä»å¤§åˆ°å°å¡«å……ï¼‰ï¼Œåˆ âˆµ ä¸¤ä¸ªæ•°ç»„å„è‡ªæœ‰åº âˆ´ åªéœ€ä»åå¾€å‰éå†å³å¯ï¼š
     *
     *   å¯¹äº nums1 = [1, 2, 3, 8, 0, 0, 0], nums2 = [2, 5, 6]ï¼š
     *     -> 8 > 6 âˆ´ [1, 2, 3, 8, 0, 0, 8]
     *     -> 3 < 6 âˆ´ [1, 2, 3, 8, 0, 6, 8]
     *     -> 3 < 5 âˆ´ [1, 2, 3, 8, 5, 6, 8]
     *     -> 3 > 2 âˆ´ [1, 2, 3, 3, 5, 6, 8]
     *     -> 2 = 2 âˆ´ [1, 2, 2, 3, 5, 6, 8]
     *     -> 1 < 2 âˆ´ [1, 2, 2, 3, 5, 6, 8]  - è‡³æ­¤ nums2 ä¸­çš„å…ƒç´ å·²å…¨éƒ¨å¤„ç†å®Œæ¯•
     *
     *   è¯¥å®ç°ä¸­è—æœ‰ä¸€ä¸ªä¼˜åŒ– â€”â€” å½“ nums2 ä¸­çš„å…ƒç´ å·²å…¨éƒ¨å¤„ç†å®Œæ—¶ï¼Œæ•´ä¸ªæ’åºå°±å·²ç»å®Œæˆï¼ˆâˆµ æ­¤æ—¶ nums1 ä¸­å‰©ä½™çš„å…ƒç´ éƒ½ < nums2 ä¸­
     *   çš„æœ€å°å…ƒç´  âˆ´ nums1 ä¸­å‰©ä½™å…ƒç´ çš„ä½ç½®ä¸ç”¨å†å˜ï¼‰ã€‚
     *
     * - æ—¶é—´å¤æ‚åº¦ O(m)ï¼Œç©ºé—´å¤æ‚åº¦ O(1)ã€‚
     * */
    private static void merge3(int[] nums1, int m, int[] nums2, int n) {
        int i = m - 1, j = n - 1;
        for (int k = m + n - 1; k >= 0 && j >= 0; k--) {  // åŠ ä¸Šæ¡ä»¶ j>=0 å°±æ˜¯è¦åœ¨ nums2 ä¸­çš„å…ƒç´ å…¨éƒ¨å¤„ç†å®Œæ—¶ç»“æŸæ•´ä¸ªæ’åº
            if (i >= 0 && nums1[i] >= nums2[j])
                nums1[k] = nums1[i--];
            else
                nums1[k] = nums2[j--];
        }
    }

    public static void main(String[] args) {
        int[] arr1 = new int[]{1, 2, 3, 8, 0, 0, 0};  // nums1 çš„æœ‰æ•ˆå…ƒç´ æ¯” nums2 å¤šçš„æƒ…å†µ
        int[] arr2 = new int[]{2, 5, 6};
        merge(arr1, 4, arr2, 3);
        log(arr1);                                    // expects [1, 2, 2, 3, 5, 6, 8]

        int[] arr3 = new int[]{1, 3, 6, 0, 0, 0, 0};
        int[] arr4 = new int[]{2, 3, 6, 7};           // nums2 çš„æœ‰æ•ˆå…ƒç´ æ¯” nums1 å¤šçš„æƒ…å†µ
        merge(arr3, 3, arr4, 4);
        log(arr3);                                    // expects [1, 2, 3, 3, 6, 6, 7]
    }
}
